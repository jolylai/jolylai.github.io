<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="Uplaod"/>




  <meta name="keywords" content="Antd," />




  <link rel="alternate" href="/atom.xml" title="Jolylai">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.0.0" />



<link rel="canonical" href="http://yoursite.com/2017/11/10/Antd-Upload/"/>


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.0" />



  



    <title> Uplaod · Jolylai </title>
  </head>

  <body>
    <div class="container">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Jolylai</a>
</div>

<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            Home
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            Archives
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            Tags
          </a>
        </li>
      
      
        <li class="menu-search">
          <form>
            <i class="iconfont icon-search" id="open-search"></i>
            <input type="text" class="search-input" id="search-input" />
            <i class="iconfont icon-close" id="close-search"></i>
          </form>
        </li>
      
    </ul>
  
</nav>

<div class="mobile-navbar">
  <div class="mobile-header">
    <div class="mobile-header-logo">
      <a href="/." class="logo">Jolylai</a>
    </div>

    <div class="mobile-header-icon">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
  <nav class="mobile-menu">
    
      
      <a class="mobile-menu-item" href="/">
        Home
      </a>
    
      
      <a class="mobile-menu-item" href="/archives/">
        Archives
      </a>
    
      
      <a class="mobile-menu-item" href="/tags">
        Tags
      </a>
    
  </nav>
</div>
      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          Uplaod
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          Nov 10, 2017
        </span>
      </div>
    </header>

    
      <div class="post-toc" id="post-toc">
        <h2 class="post-toc-title">Contents</h2>
        <div class="post-toc-content">
          <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Upload组件结合Form"><span class="toc-text">Upload组件结合Form</span></a></li></ol>
        </div>
      </div>
    

    <div class="post-content">
      
        <p>&#x4F7F;&#x7528;Antd&#x7684;Upload&#x7EC4;&#x4EF6;&#x5BF9;&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x4E0A;&#x4F20;</p>
<a id="more"></a>
<h2 id="Upload&#x7EC4;&#x4EF6;&#x7ED3;&#x5408;Form"><a href="#Upload&#x7EC4;&#x4EF6;&#x7ED3;&#x5408;Form" class="headerlink" title="Upload&#x7EC4;&#x4EF6;&#x7ED3;&#x5408;Form"></a>Upload&#x7EC4;&#x4EF6;&#x7ED3;&#x5408;Form</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&apos;react&apos;</span></div><div class="line"><span class="keyword">import</span> { Upload, Button, Icon, Form } <span class="keyword">from</span> <span class="string">&apos;antd&apos;</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> FormItem = Form.Item</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyUpload</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>{</div><div class="line">  state = {</div><div class="line">    <span class="attr">fileList</span>: [{</div><div class="line">      <span class="attr">uid</span>: <span class="number">-1</span>,</div><div class="line">      <span class="attr">name</span>: <span class="string">&apos;xxx.png&apos;</span>,</div><div class="line">      <span class="attr">status</span>: <span class="string">&apos;done&apos;</span>,</div><div class="line">      <span class="attr">url</span>: <span class="string">&apos;http://www.baidu.com/xxx.png&apos;</span>,</div><div class="line">    }],</div><div class="line">  }</div><div class="line">  handleChange = <span class="function">(<span class="params">info</span>) =&gt;</span> {</div><div class="line">    <span class="comment">// file &#x6B63;&#x5728;&#x4E0A;&#x4F20;&#x7684;&#x6587;&#x4EF6;</span></div><div class="line">    <span class="comment">// fileList &#x6B63;&#x5728;&#x4E0A;&#x4F20;&#x548C;&#x5DF2;&#x4E0A;&#x4F20;&#x7684;&#x6587;&#x4EF6;</span></div><div class="line">    <span class="keyword">let</span> { file, fileList } = info;</div><div class="line"></div><div class="line">    <span class="comment">// 1. Limit the number of uploaded files</span></div><div class="line">    <span class="comment">//    Only to show two recent uploaded files, and old ones will be replaced by the new</span></div><div class="line">    fileList = fileList.slice(<span class="number">-2</span>);</div><div class="line"></div><div class="line">    <span class="comment">// 2. read from response and show file link</span></div><div class="line">    fileList = fileList.map(<span class="function">(<span class="params">file</span>) =&gt;</span> {</div><div class="line">      <span class="comment">// &#x5BF9;file&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x53D6;&#x6240;&#x9700;&#x7684;&#x5B57;&#x6BB5;&#xFF0C;&#x4F7F;file&#x770B;&#x8D77;&#x6765;&#x7B80;&#x6D01;</span></div><div class="line">      <span class="keyword">if</span> (file.response) {</div><div class="line">        <span class="comment">// Component will show file.url as link</span></div><div class="line">        file.url = file.response.url;</div><div class="line">      }</div><div class="line">      <span class="keyword">return</span> file;</div><div class="line">    });</div><div class="line"></div><div class="line">    <span class="comment">// 3. filter successfully uploaded files according to response from server</span></div><div class="line">    fileList = fileList.filter(<span class="function">(<span class="params">file</span>) =&gt;</span> {</div><div class="line">      <span class="keyword">if</span> (file.response) {</div><div class="line">        <span class="keyword">return</span> file.response.status === <span class="string">&apos;success&apos;</span>;</div><div class="line">      }</div><div class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    });</div><div class="line">    <span class="comment">// &#x53D7;&#x63A7;&#x7EC4;&#x4EF6;</span></div><div class="line">    <span class="comment">// Upload&#x63A7;&#x4EF6;onChange&#x65B9;&#x6CD5;&#x53EA;&#x4F1A;&#x6267;&#x884C;&#x4E00;&#x6B21;&#xFF0C;&#x4E14;info.file.status&#x4E00;&#x76F4;&#x4E3A;uploading</span></div><div class="line">    <span class="keyword">this</span>.setState({ fileList });</div><div class="line">  }</div><div class="line">  render() {</div><div class="line">    <span class="keyword">const</span> { getFieldDecorator } = <span class="keyword">this</span>.props.form</div><div class="line">    <span class="keyword">const</span> { fileList } = <span class="keyword">this</span>.state</div><div class="line">    <span class="keyword">const</span> uploadProps = {</div><div class="line">      <span class="attr">action</span>: <span class="string">&apos;//jsonplaceholder.typicode.com/posts/&apos;</span>,</div><div class="line">      <span class="attr">listType</span>: <span class="string">&quot;picture&quot;</span>,</div><div class="line">      <span class="attr">multiple</span>: <span class="literal">true</span>,</div><div class="line">      <span class="attr">onRemove</span>: <span class="function"><span class="params">()</span> =&gt;</span> {</div><div class="line">        <span class="keyword">if</span> (canDelete) {</div><div class="line">            message.info(<span class="string">&apos;&#x4E0D;&#x53EF;&#x5220;&#x9664;&apos;</span>)</div><div class="line">            <span class="keyword">return</span> <span class="literal">false</span></div><div class="line">        }</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span></div><div class="line">      }</div><div class="line">    };</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">Form</span>&gt;</span></span></div><div class="line">        <span class="tag">&lt;<span class="name">FormItem</span>&gt;</span></div><div class="line">          {</div><div class="line">            getFieldDecorator(&apos;upload&apos;, {</div><div class="line">              rules: [{ required: true, message: &apos;upload file please!&apos; }],</div><div class="line">              valuePropName: &apos;fileList&apos;,  //&#x5B50;&#x8282;&#x70B9;&#x7684;&#x503C;&#x7684;&#x5C5E;&#x6027;,&#x9ED8;&#x8BA4;&#x2018;value&#x2019;</div><div class="line">              getValueFromEvent: handleChange,  //&#x53EF;&#x4EE5;&#x628A; onChange &#x7684;&#x53C2;&#x6570;&#x8F6C;&#x5316;&#x4E3A;&#x63A7;&#x4EF6;&#x7684;&#x503C;</div><div class="line">              initialValue: fileList</div><div class="line">            })(</div><div class="line">              <span class="tag">&lt;<span class="name">Upload</span> {<span class="attr">...uploadProps</span>}&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">Button</span>&gt;</span></div><div class="line">                  <span class="tag">&lt;<span class="name">Icon</span> <span class="attr">type</span>=<span class="string">&quot;upload&quot;</span> /&gt;</span> upload</div><div class="line">                <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></div><div class="line">              <span class="tag">&lt;/<span class="name">Upload</span>&gt;</span></div><div class="line">            )</div><div class="line">          }</div><div class="line">        <span class="tag">&lt;/<span class="name">FormItem</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">Form</span>&gt;</span></div><div class="line">    );</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line">export default Form.create()(MyUpload);</div></pre></td></tr></table></figure>
<ul>
<li><a href="https://facebook.github.io/react/docs/forms.html#controlled-components" target="_blank" rel="external">&#x53D7;&#x63A7;&#x7EC4;&#x4EF6;</a></li>
<li>Upload&#x63A7;&#x4EF6;onChange&#x65B9;&#x6CD5;&#x53EA;&#x4F1A;&#x6267;&#x884C;&#x4E00;&#x6B21;&#xFF0C;&#x4E14;info.file.status&#x4E00;&#x76F4;&#x4E3A;uploading &#x67E5;&#x770B;handleChange&#x4E2D;this.setState({ fileList });</li>
<li>&#x5982;&#x679C;&#x9700;&#x8981;&#x5411;handleChange&#x4F20;&#x5165;&#x5176;&#x4ED6;&#x53C2;&#x6570;<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">getFieldDecorator(<span class="string">&apos;upload&apos;</span>, {</div><div class="line">  <span class="attr">getValueFromEvent</span>: <span class="function">(<span class="params">info</span>) =&gt;</span> handleChange(info, ect)</div><div class="line">})()</div></pre></td></tr></table></figure></li>
</ul>

      
    </div>

    
      <footer class="post-footer">
        <div class="post-tags">
          
            <a href="/tags/Antd/">Antd</a>
          
        </div>

        
  <nav class="post-nav">
    
      <a class="prev" href="/2017/11/10/React-组合式组件开发/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">组合式组件开发实践</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2017/11/06/React-高阶组件/">
        <span class="next-text nav-default">高阶组件</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    
  </article>


          </div>
          
  <div class="comments" id="comments">
    
  </div>

        </div>  
      </main>

      <footer id="footer" class="footer">
  <div class="social-links">
    
      
        
          <a href="mailto:2635850288@qq.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
        
          <a href="https://github.com/jolylai" class="iconfont icon-github" title="github"></a>
        
      
    
      
    
      
        
          <a href="https://www.zhihu.com/people/since-new/activities" class="iconfont icon-zhihu" title="zhihu"></a>
        
      
    
    
    
  </div>


<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a>
  </span>
  
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2016 - 
    
    2017

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Jolylai</span>
  </span>
</div>
      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    


    


  <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>

    <script type="text/javascript" src="/js/src/even.js?v=2.0.0"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.0.0"></script>

  </body>
</html>